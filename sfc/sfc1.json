{
    "name": "sfc1",
    "operation": "create",
    "VNF": [
        {
            "name": "vnf1",
            "type": "FW",
            "flavor": {
                "cpu": 1,
                "memory": 1,
                "disk": 10
            },
            "rule": "sudo iptables -A FORWORD -p icmp -j REJECT"
        },
        {
            "name": "vnf2",
            "type": "IDS",
            "flavor": {
                "cpu": "1",
                "memory": 2,
                "disk": 15
            },
            "rule": "alert tcp !$HOME_NET any -> $HOME_NET 22 (flags: S; msg:\"Possible TCP DoS\"; flow: stateless; \nthreshold: type both, track by_src, count 70, seconds 10; sid:10001;rev:1;)"
        },
        {
            "name": "vnf3",
            "type": "IDS",
            "flavor": {
                "cpu": "1",
                "memory": 2,
                "disk": 15
            },
            "rule": "alert tcp !$HOME_NET any -> $HOME_NET 22 (flags: S; msg:\"Possible TCP DoS\"; flow: stateless; \nthreshold: type both, track by_src, count 70, seconds 10; sid:10001;rev:1;)"
        },
        {
            "name": "vnf4",
            "type": "IDS",
            "flavor": {
                "cpu": "1",
                "memory": 2,
                "disk": 15
            },
            "rule": "alert tcp !$HOME_NET any -> $HOME_NET 22 (flags: S; msg:\"Possible TCP DoS\"; flow: stateless; \nthreshold: type both, track by_src, count 70, seconds 10; sid:10001;rev:1;)"
        },
        {
            "name": "vnf2",
            "type": "IDS",
            "flavor": {
                "cpu": "1",
                "memory": 2,
                "disk": 15
            },
            "rule": "alert tcp !$HOME_NET any -> $HOME_NET 22 (flags: S; msg:\"Possible TCP DoS\"; flow: stateless; \nthreshold: type both, track by_src, count 70, seconds 10; sid:10001;rev:1;)"
        },
        {
            "name": "vnf5",
            "type": "IDS",
            "flavor": {
                "cpu": "1",
                "memory": 2,
                "disk": 15
            },
            "rule": "alert tcp !$HOME_NET any -> $HOME_NET 22 (flags: S; msg:\"Possible TCP DoS\"; flow: stateless; \nthreshold: type both, track by_src, count 70, seconds 10; sid:10001;rev:1;)"
        }
    ],
    "constrain": [
        {
            "name": "cons1",
            "former": "vnf2",
            "later": "vnf1"
        },
        {
            "name": "cons2",
            "former": "vnf4",
            "later": "vnf3"
        }
    ],
    "QoS": {
        "Bandwidth": "10M",
        "delay": "20ms"
    }
}
